# Docker Compose override for test runner (run-tests.sh)
# Uses .env-tests (generated by run-tests.sh) instead of .env-docker
#
# Usage (via run-tests.sh):
#   ./run-tests.sh --backend
#
# This file is auto-used by run-tests.sh and provides:
# - Separate DB volume for test isolation
# - env_file overrides to use .env-tests
# - Disabled preview service (not needed for tests)

services:
  ws-db:
    # Use a different volume to avoid conflicts with dev database
    volumes:
      - ws-tests-db-data:/var/lib/postgresql/data/pgdata
    env_file:
      - .env-tests

  ws-web:
    env_file:
      - .env-tests

  ws-rq:
    env_file:
      - .env-tests

  ws-preview:
    # Disable preview service for tests - not needed
    profiles:
      - disabled

volumes:
  ws-tests-db-data:
